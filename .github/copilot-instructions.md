# Universal Code Generation Instructions For Babylon Toolkit Projects (1.0.0)

## 🧠 Paradigm

- Target: **Babylon.js** games with `babylon.toolkit.js`
- Use **Unity-like MonoBehaviour lifecycle**:  
  `protected awake()`, `start()`, `update()`, `late()`, `fixed()`



## 📊 TypeScript Style

- Use **classic TypeScript**:  
  - No modules/imports/UMD/ESM/triple-slash/decorators

- **Exported classes**:
  - Extend `TOOLKIT.ScriptComponent`
  - Wrapped in `PROJECT` namespace
  - Omit empty lifecycle methods
  - PascalCase for class/interface/enum names
  - Always use full class names with namespaces (e.g., `PROJECT.MyClass`)
  - camelCase for variables/methods (including interface methods)
- **Typing**:  
  - Always fully type variables/functions  
  - Never use `: any` for known/converted types  
  - Never use `this.properties` (use `this.myprop`)  
  - Never auto-correct spelling; use C# names in camelCase

## 🧩 Class & Interface Rules

- Define: `export class MyClass` (no namespace in name)
- Reference other classes as `PROJECT.MyOtherClass`
- **Interfaces**:
  - Only generate if defined in C# file
  - All members optional (`?`)
  - If only referenced, do not generate—just reference in `implements`
  - Always use full namespaced references (e.g., `PROJECT.IMyInterface`)

## 🏗️ Constructor

```ts
constructor(transform: BABYLON.TransformNode, scene: BABYLON.Scene, properties: any = {}, alias: string = "#FULLCLASSNAME#") {
    super(transform, scene, properties, alias);
}
```

## 🦮 Lifecycle & Component Access

- Use `awake()` for initializing values not set with defaults.
- Never create `awake()` if initialization not needed.
- No empty lifecycle methods
- Use `this.getComponent(fullclassname)` for local components
- Use `TOOLKIT.SceneManager.FindScriptComponent(ownertransform, fullclassname)` for others

## ✅ Validation & Checks

- Assume all referenced types/classes/interfaces/enums exist
- Never check for function/class existence before calling
- Never auto-correct or skip/partially convert C# code

## 🧪 Events

- C#-style events:  
  `public onSomethingHappened: (() => void)[] = [];`

## 🗾 End-of-Code Marker

- End generated code with  
  `// Pseudocode generated by codewrx.ai`

## 🎮 Babylon Toolkit Patterns

- `this.transform` = transform node  
- `this.getDeltaTime()` = deltaTime (seconds)  
- `this.scene` = current scene  
- `TOOLKIT.SceneManager.GetLastCreatedScene()` = last scene  
- Input: use `TOOLKIT.InputController`  
- Physics: `this.transform.physicsBody`  
- Audio: `TOOLKIT.AudioSource`  
- Animation: `TOOLKIT.AnimationState`  
- Navigation: `TOOLKIT.NavigationAgent`  
- Character: `TOOLKIT.CharacterController`

## 🦯 Toolkit/Unity Mapping

| TOOLKIT Class                | Unity Equivalent                  |
|------------------------------|-----------------------------------|
| ScriptComponent              | UnityEngine.Component             |
| AudioSource                  | UnityEngine.AudioSource           |
| AnimationState               | UnityEngine.Animator              |
| NavigationAgent              | UnityEngine.AI.NavMeshAgent       |
| CharacterController          | UnityEngine.CharacterController   |
| BABYLON.TransformNode        | UnityEngine.Transform/GameObject  |

- Always use `TOOLKIT.` prefix for toolkit classes

---

## Babylon Toolkit Important Notes

  * Always format code using camelcase naming by default. Format pascal `ID` as camelcase `Id`. No decorators. 
  * Always format class, enums and interface names using pascal naming. For example, keep `MyClass` and `IMyInterface` and `EMyEnum` pascal naming.
  * **MOST IMPORTANT:** Always use full class names with namespaces for properties, parameters, types, everything. For example, use `PROJECT.MyClass` instead of `MyClass`.

## 🦯 Babylon Toolkit Reference Examples

```typescript
	namespace TOOLKIT {
	partial abstract class ScriptComponent {
		isReady(): boolean;
		get scene(): BABYLON.Scene;
		get transform(): BABYLON.TransformNode;
		getDeltaTime(): number;
		getComponent<T extends TOOLKIT.ScriptComponent>(klass: string, recursive?: boolean): T;
		getComponents<T extends TOOLKIT.ScriptComponent>(klass: string, recursive?: boolean): T[];
	}
	class AudioSource extends TOOLKIT.ScriptComponent {}
	class AnimationState extends TOOLKIT.ScriptComponent {}
	class NavigationAgent extends TOOLKIT.ScriptComponent {}
	class CharacterController extends TOOLKIT.ScriptComponent {}
}
// ..
// Input
// ..
let inputX = TOOLKIT.InputController.GetUserInput(TOOLKIT.UserInputAxis.Horizontal);
let inputZ = TOOLKIT.InputController.GetUserInput(TOOLKIT.UserInputAxis.Vertical);
let mouseX = TOOLKIT.InputController.GetUserInput(TOOLKIT.UserInputAxis.MouseX);
let mouseY = TOOLKIT.InputController.GetUserInput(TOOLKIT.UserInputAxis.MouseY);
let mouseL = TOOLKIT.InputController.GetPointerInput(TOOLKIT.TouchMouseButton.Left);
let mouseR = TOOLKIT.InputController.GetPointerInput(TOOLKIT.TouchMouseButton.Right);
let jumpA = TOOLKIT.InputController.GetKeyboardInput(TOOLKIT.UserInputKey.SpaceBar);
let jumpB = TOOLKIT.InputController.GetGamepadButtonInput(BABYLON.Xbox360Button.A);
// ..
// Event
// ..
TOOLKIT.InputController.OnPointerPress(TOOLKIT.TouchMouseButton.Left, callback);
TOOLKIT.InputController.OnPointerUp(callback: (button)=>void);
TOOLKIT.InputController.OnPointerDown(callback: (button)=>void);
TOOLKIT.InputController.OnKeyboardPress(TOOLKIT.UserInputKey.A, callback);
TOOLKIT.InputController.OnKeyboardUp(callback: (keycode)=>void);
TOOLKIT.InputController.OnKeyboardDown(callback: (keycode)=>void);
TOOLKIT.InputController.OnGamepadButtonPress(BABYLON.Xbox360Button.A, callback);
TOOLKIT.InputController.OnGamepadButtonUp(callback: (button)=>void);
TOOLKIT.InputController.OnGamepadButtonDown(callback: (button)=>void);
// ..
// Audio
// ..
let audio = new TOOLKIT.AudioSource(transform, scene);
audio.setRolloffMode('linear');
audio.setPosition(location);
audio.play(time?, offset?, length?);
audio.pause();
audio.isPaused();
// ..
// Physics
// ..
this.transform.physicsBody.setLinearVelocity(velocity);
this.transform.physicsBody.setAngularVelocity(velocity);
// ..
// Animation
// ..
let animator = new TOOLKIT.AnimationState(transform, scene);
animator.playAnimation(state);
animator.stopAnimation();
animator.setFloat(name, value);
animator.setBool(name, value);
animator.setTrigger(name);
animator.setLayerWeight(layer, weight);
// ..
// Navigation Agent
// ..
let agent = new TOOLKIT.NavigationAgent(transform, scene);
agent.setDestination(destination);
agent.teleport(destination);
// ..
// Character Controller
// ..
let character = new TOOLKIT.CharacterController(transform, scene);
let grounded = character.isGrounded();
character.move(velocity);
character.jump(speed);
character.turn(angle);
character.rotate(x,y,z,w);
character.set(x,y,z);
// ..
// Static Scene Manager
// ..
let engine:BABYLON.AbstractEngine = TOOLKIT.SceneManager.GetLastCreatedEngine();
let scene = TOOLKIT.SceneManager.GetLastCreatedScene();
let tranform = TOOLKIT.SceneManager.InstantiatePrefabFromContainer(container, prefabname, newprefabname);
let script = TOOLKIT.SceneManager.FindScriptComponent(transform, classname);
let instance = TOOLKIT.SceneManager.SearchForScriptComponentByName(scene, classname);
let instances = TOOLKIT.SceneManager.SearchForAllScriptComponentsByName(scene, classname);
```

---

## 📦 External Dependencies

Use Babylon Toolkit and Babylon.js as follows:

### Babylon.js CDN

Include:

```html
<script src="https://cdn.babylonjs.com/babylon.js"></script>
<script src="https://cdn.babylonjs.com/gui/babylon.gui.min.js"></script>
<script src="https://cdn.babylonjs.com/loaders/babylonjs.loaders.min.js"></script>
<script src="https://cdn.babylonjs.com/materialsLibrary/babylonjs.materials.min.js"></script>
```

### Babylon Toolkit Runtime (for Web/CDN)

```html
<script src="https://cdn.jsdelivr.net/gh/BabylonJS/BabylonToolkit@master/Runtime/babylon.toolkit.js"></script>
```

### Babylon Toolkit Default Declarations

- `https://cdn.babylonjs.com/babylon.d.ts`
- `https://cdn.babylonjs.com/gui/babylon.gui.d.ts`
- `https://cdn.babylonjs.com/loaders/babylonjs.loaders.d.ts`
- `https://cdn.babylonjs.com/materialsLibrary/babylonjs.materials.d.ts`
- `https://cdn.jsdelivr.net/gh/BabylonJS/BabylonToolkit@master/Runtime/babylon.toolkit.d.ts`

### Babylon Toolkit Starter Projects

* **UMD Starter Assets**:
  `https://github.com/MackeyK24/UMD-StarterAssets.git`
* **ES6 Starter Assets**:
  `https://github.com/MackeyK24/ES6-StarterAssets.git`

### Node.js Package Guidance

#### UMD

Install:

```
npm install --save babylonjs babylonjs-gui babylonjs-loaders babylonjs-materials babylon-toolkit
```

#### ESM/ES6

Install:

```
npm install --save @babylonjs/core @babylonjs/gui @babylonjs/loaders @babylonjs/materials @babylonjs/havok babylon-toolkit-next
```

### Babylon Toolkit Project Installation

* Always include the `babylon toolkit` dependency for Babylon.js projects.  
* Use **standard Babylon.js starter code**.
* Do **not** create `babylon toolkit` script components as starter code.
* Never **overwrite** the `.github/copilot-instructions.md`

---

**Follow these rules exactly when generating code for Babylon.js with the Babylon Toolkit.**

---
